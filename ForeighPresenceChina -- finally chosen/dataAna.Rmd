---
title: "Foreign Presence & ETCs"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library we need}
library(ggplot2)
library(scales)
```

## 1. Explore the dataset
```{r}
load("./ForeighPresenceChina -- finally chosen/ForeignPresence&ETCs.RData")
data <- as.data.frame(x)
str(data)
View(summary(data))
mode(data[,"province"])
```

## 2. Statistics description of the dataset 
### 2.1 About the province
#### 2.1.1 Explore the provinces
```{r}
summary(as.factor(data[,"province"]))

# plot the numbers of sample of different provinces
ggplot(data) + geom_bar(aes(x = as.factor(province)))+ theme(axis.text.x = element_text(angle = 45,colour = "black",size=13,hjust=1))

#get the data for province
data.prov <- as.data.frame(data[!duplicated(x[,"province"]),])

#plot the GDP of different provinces
ggplot(data.prov) + geom_bar(aes(x = as.factor(province), y = gdp2003),stat = "identity", position = "dodge") + theme(axis.text.x = element_text(angle = 45,colour = "black",size=13,hjust=1))

```

From the barchart, we can know that The first highest three GDP provinces are Guangdong, Jiangsu and Shandong. The last three GDP provinces are Qinghai, Ningxia and Hainan.

### 2.1.2 Describe the relationship between the total population and capital GDP for different provinces.
```{r}
ggplot(data.prov) + geom_line(aes(x = lpop2003, y = lgdpper2003))
cor.test(data.prov[,"lpop2003"], data.prov[,"lgdpper2003"])

```

So we can get that there is no strong relationship between the population and capital. From the correlation test result, we found that the p value is 0.4043, which is much larger than 0.05, so we can not reject the Null Hypothesis at a 95% confindence level. There is no strong correlation between these two variables.

### 2.1.3 Describe the relationship between the weighted geographic distance and capital GDP for different provinces.
```{r}
ggplot(data.prov) + geom_point(aes(x = lwdist, y = lgdpper2003))
cor.test(data.prov[,"lwdist"], data.prov[,"lgdpper2003"])

```

So we can get that there is no strong relationship between the weighted geographic distance and capital GDP. From the correlation test result, we found that the p value is 0.3297, which is much larger than 0.05, so we can not reject the Null Hypothesis at a 95% confindence level. There is no strong correlation between these two variables. But these two variables are positive correlated, which means the larger the weighted geographic distance, the more capital GDP of the province.

### 2.1.4 The proportion of 
```{r pressure, echo=FALSE}
plot(pressure)

```

### 2.1.5 Description of the firms ownership 
```{r}
x[,"ownership"] <- NA
for (j in 1:nrow(x)){
  if (x[j,"soe"] == 1) x[j,"ownership"] <- "state"
  if (x[j,"collective"] == 1) x[j,"ownership"] <- "collective"
  if (x[j,"private"] == 1) x[j,"ownership"] <- "private"
  if (x[j,"foreign_HMT"] == 1) x[j,"ownership"] <- "foreign_HMT"
  if (x[j,"foreign_NonHMT"] == 1) x[j,"ownership"] <- "foreign_NonHMT"
  if (x[j,"mixedown"] == 1) x[j,"ownership"] <- "mixed"
}

count(x[,"ownership"])

ggplot(data=x) + geom_bar(aes(ownership))

```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
