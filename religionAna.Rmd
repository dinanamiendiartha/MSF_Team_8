---
title: "Religion Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Explore dataset
First, let's explore the target dataset(PublicDataSet_ReligiousRestrictions_2007to2014.dta)
```{r cars}
library(foreign)
data <- read.dta("PublicDataSet_ReligiousRestrictions_2007to2014.dta")
View(data)
str(data)
```
So we got the information that there are 81 variables and 1580 objections.

From the document, we know that the data are presented as a semiwide-format dataset, in which each row is a country-year observation(for example,"Afghanistan, 2007"). The dataset covers 198 countries and self-administering territories: 192 of the 193 member states of the United Nations as of 2013, plus 6 self-administering territories - Kosovo, Hong Kong, Macau, the Palestinian territories, Taiwan and Western Sahara. Some of these institutions don't have the whole data from 2007 to 2014 but juse a few years(for example, the South Sudan only has the data from 2011 to 2014)

The coulums contain all of the variables presented in Pew Research Center's annual reports on restrictions on religion. as well as some additional variables analyzed in separate studies. The **Government Restrictions Index(GRI)** is based on **20** indicators of ways that national and local government restrict religion, including through coercion and force. The **Social Hostilities Index(SHI)** is based on **13** indicators of ways in which private individuals and social groups infringe upon religious beliefs and pritices, including religiously biased crimes, mob violence and efforts to stop particular religious groups from growing or oprating. 

|**Variable**|**Description**|
|:-----------|:--------------|
|`Nation_fk`|Index of countries|
|`Region5`|5 regions each country belong to|
|`Region6`|6 regions each country belong to
|`Ctry_EditorialName`|Country name|
|`Question_Year`|Observation year|
|`GRI`|Government restriction index from 0 to 10. Higher number indicates higher government restriction|
|`SHI`|Social Hostilities Index from 0 to 10. Higher number indicates higher social hostilities|
|`GRI_Q_1`|Whether a country's constitution explicitly protect religious freedom. (0 = Yes, 0.5 = Does not mention specifically but protects religious practices, 1 = No)
|`GRI_Q_2`|Whether a country's constitution 
|`GRI_Q_3`|
|`GRI_Q_4`|
|`GRI_Q_5`|
|`GRI_Q_6`|
|`GRI_Q_7`|
|`GRI_Q_8`|
|`GRI_Q_9`|
|`GRI_Q_10`|
|`GRI_Q_11`|
|`GRI_Q_11_Christianity`|
|`GRI_Q_11_Islam`|
|`GRI_Q_11_Buddhism`|
|`GRI_Q_11_Hinduism`|
|`GRI_Q_11_Judaism`|
|`GRI_Q_11_Folk_Religions`|
|`GRI_Q_11_Other_Religions`|
|`GRI_Q_12`|
|`GRI_Q_13`|
|`GRI_Q_14`|
|`GRI_Q_15`|
|`GRI_Q_16`|
|`GRI_Q_16_reasons`|
|`GRI_Q_17`|
|`GRI_Q_18`|
|`GRI_Q_19`|
|`GRI_Q_19_extent`|
|`GRI_Q_19_Property_Damage`|
|`GRI_Q_19_Detentions`|
|`GRI_Q_19_Displacements`|
|`GRI_Q_19_Abuse`|
|`GRI_Q_19_Deaths`|
|`GRI_Q_20`|
|`GRI_Q_20_1`|
|`GRI_Q_20_2`|
|`GRI_Q_20_3`|
|`GRI_Q_20_3_a`|
|`GRI_Q_20_3_b`|
|`GRI_Q_20_3_c`|
|`GRI_Q_20_4`|
|`GRI_Q_20_5`|
|`SHI_Q_1_Harassment`|
|`SHI_Q_1_Property_Damage`|
|`SHI_Q_1_Detentions`|
|`SHI_Q_1_Displacements`|
|`SHI_Q_1_Assaults`|
|`SHI_Q_1_Deaths`|
|`SHI_Q_1_Extent`|
|`SHI_Q_1_harass_Christianity`|
|`SHI_Q_1_harass_Islam`|
|`SHI_Q_1_harass_Buddhism`|
|`SHI_Q_1_harass_Hinduism`|
|`SHI_Q_1_harass_Judaism`|
|`SHI_Q_1_harass_Folk_Religions`|
|`SHI_Q_1_harass_Other_Religions`|
|`SHI_Q_2`|
|`SHI_Q_3`|
|`SHI_Q_4`|
|`SHI_Q_4_extent`|
|`SHI_Q_5`|
|`SHI_Q_5_extent`|
|`SHI_Q_6`|
|`SHI_Q_7`|
|`SHI_Q_8`|
|`SHI_Q_9`|
|`SHI_Q_10`|
|`SHI_Q_11`|
|`SHI_Q_12`|
|`SHI_Q_13`|
|`GRX_22_blasphemy`|
|`GRX_22_apostasy`|
|`GRX_22_hate_speech`|
|`GRX_22_criticism_of_religion`|
|`GRX_30`|  


```{r libraries}
library(ggplot2)
library(reshape2)
```

# Questions

## Question 1: Research about different region
### 1. Explore the GRI and SHI of different regions and find out which one has the highest restrictions and lowest restrictions.
```{r}
region.name <- c(unique(data[,"Region6"])) # find out how many regions in total
# Calculate the average GRI of 6 regions
region.GRI <- c()
for(i in unique(data[,"Region6"])){
  region.GRI <- c(region.GRI, mean(data[data[,"Region6"] == i,"GRI"]))
}
# Calculate the average SHI of 6 regions
region.SHI <- c()
for(i in unique(data[,"Region6"])){
  region.SHI <- c(region.SHI, mean(data[data[,"Region6"] == i,"SHI"]))
}
# Construct the region dataframe
region <- data.frame(region.name = region.name, region.GRI = region.GRI, region.SHI = region.SHI)
region
## Plot the GRI barchart
ggplot(region) + geom_bar(mapping = aes(x = region.name, y = region.GRI), stat = "identity", position = "dodge", fill = "steelblue") + labs(title = "GRI of 6 regions")

## Plot the SHI barchart
ggplot(region) + geom_bar(mapping = aes(x = region.name, y = region.SHI), stat = "identity", position = "dodge", fill = "steelblue") + labs(title = "SHI of 6 regions")

```

From the barchart, we can get the conclusion that Middle East-North Africa has the highest Government restrictions(5.66) and highest impediments(4.59), and Latin America-Caribbean has the lowest Government restrictions(1.58) and lowest impediments(0.74).

### 2. What is the average GRI and SHI in different regions in different years from 2007 to 2014?
```{r}
GRI.2007 <- c(); SHI.2007 <- c()
GRI.2008 <- c(); SHI.2008 <- c()
GRI.2009 <- c(); SHI.2009 <- c()
GRI.2010 <- c(); SHI.2010 <- c()
GRI.2011 <- c(); SHI.2011 <- c()
GRI.2012 <- c(); SHI.2012 <- c()
GRI.2013 <- c(); SHI.2013 <- c()
GRI.2014 <- c(); SHI.2014 <- c()

for(i in unique(data[,"Region6"])){
  GRI.2007 <- c(GRI.2007, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2007), "GRI"]))
  GRI.2008 <- c(GRI.2008, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2008), "GRI"]))
  GRI.2009 <- c(GRI.2009, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2009), "GRI"]))
  GRI.2010 <- c(GRI.2010, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2010), "GRI"]))
  GRI.2011 <- c(GRI.2011, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2011), "GRI"]))
  GRI.2012 <- c(GRI.2012, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2012), "GRI"]))
  GRI.2013 <- c(GRI.2013, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2013), "GRI"]))
  GRI.2014 <- c(GRI.2014, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2014), "GRI"]))
  
  SHI.2007 <- c(SHI.2007, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2007), "SHI"]))
  SHI.2008 <- c(SHI.2008, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2008), "SHI"]))
  SHI.2009 <- c(SHI.2009, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2009), "SHI"]))
  SHI.2010 <- c(SHI.2010, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2010), "SHI"]))
  SHI.2011 <- c(SHI.2011, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2011), "SHI"]))
  SHI.2012 <- c(SHI.2012, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2012), "SHI"]))
  SHI.2013 <- c(SHI.2013, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2013), "SHI"]))
  SHI.2014 <- c(SHI.2014, mean(data[(data[,"Region6"] == i) & (data[,"Question_Year"] == 2014), "SHI"]))
}

region['GRI.2007'] <- GRI.2007
region['GRI.2008'] <- GRI.2008
region['GRI.2009'] <- GRI.2009
region['GRI.2010'] <- GRI.2010
region['GRI.2011'] <- GRI.2011
region['GRI.2012'] <- GRI.2012
region['GRI.2013'] <- GRI.2013
region['GRI.2014'] <- GRI.2014

region['SHI.2007'] <- SHI.2007
region['SHI.2008'] <- SHI.2008
region['SHI.2009'] <- SHI.2009
region['SHI.2010'] <- SHI.2010
region['SHI.2011'] <- SHI.2011
region['SHI.2012'] <- SHI.2012
region['SHI.2013'] <- SHI.2013
region['SHI.2014'] <- SHI.2014
region
```

```{r}
region.melt <- melt(region, id.vars = c("region.name"))
```


## Including Plots


```{r pressure, echo=FALSE}
plot(pressure)
```

